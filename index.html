<!DOCTYPE html>
<html lang="tr">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>DilekÃ§e OluÅŸtur</title>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
<style>
    body { font-family: Calibri, sans-serif; background-color: #f4f4f4; padding: 10px; margin: 0; }
    .container { max-width: 600px; margin: 20px auto; background: white; padding: 25px; box-shadow: 0 0 10px rgba(0,0,0,0.1); border-radius: 8px; }
    
    h2 { text-align: center; color: #333; font-size: 1.4rem; margin-bottom: 20px; }
    label { display: block; margin-top: 15px; font-weight: bold; font-size: 14px; }
    input, select { width: 100%; padding: 12px; margin-top: 6px; font-size: 16px; box-sizing: border-box; border: 1px solid #ccc; border-radius: 4px; }
    
    .email-wrapper { display: flex; align-items: center; gap: 8px; margin-top: 6px; }
    .email-wrapper input { margin-top: 0; flex: 1; }
    .email-wrapper span { font-weight: bold; font-size: 14px; color: #555; }

    button { width: 100%; padding: 15px; font-size: 18px; cursor: pointer; background-color: #28a745; color: white; border: none; border-radius: 4px; margin-top: 25px; font-weight: bold; }
    button:active { background-color: #1e7e34; transform: translateY(1px); }

    /* PDF AlanÄ± - Ekranda gÃ¶rÃ¼nmez */
    #pdf-container { position: absolute; left: -9999px; top: 0; }
    #dilekceOutput { background: white; color: black; width: 190mm; padding: 20mm; box-sizing: border-box; }

    .info-row { display: flex; margin-bottom: 3px; line-height: 1.2; }
    .info-label { width: 120px; font-weight: bold; }
    .info-separator { width: 20px; font-weight: bold; text-align: center; }
    .info-content { flex: 1; }

    .center-text { text-align: center; margin: 0; line-height: 1.2; font-weight: bold; text-transform: uppercase; }
    table { width: 100%; border-collapse: collapse; margin-top: 30px; table-layout: fixed; }
    table, th, td { border: 1px solid black; text-align: center; padding: 8px; font-size: 10pt; word-wrap: break-word; }
    #epostaAltMetin { color: #b30000; font-weight: bold; margin-top: 40px; text-align: center; font-size: 11pt; }
</style>
</head>
<body>

  <div class="container">
    <h2>Ã‡akÄ±ÅŸan Ders Alma DilekÃ§esi OluÅŸturma</h2>
    <form id="dilekceForm">
      <label>AdÄ±nÄ±z:</label>
      <input type="text" id="ad" required />
      
      <label>SoyadÄ±nÄ±z:</label>
      <input type="text" id="soyad" required />
      
      <label>Ã–ÄŸrenci NumarasÄ±:</label>
      <input type="text" id="numara" inputmode="numeric" required />

      <label>YTÃœ E-posta KullanÄ±cÄ± AdÄ±:</label>
      <div class="email-wrapper">
          <input type="text" id="emailUser" placeholder="kullanici.adi" required oninput="emailKontrol(this)" />
          <span>@std.yildiz.edu.tr</span>
      </div>
      
      <label>Cep Telefonu:</label>
      <input type="text" id="telefon" inputmode="tel" required />
      
      <label>OBS Ãœzerinden SeÃ§ilen Ders:</label>
      <input type="text" id="obsDers" placeholder="MAT1141 Matematik Analiz 1" required />
      
      <label>Ã‡akÄ±ÅŸma Nedeniyle Eklenecek Ders:</label>
      <input type="text" id="yeniDers" placeholder="FIZ1001 Fizik 1" required />
      
      <label>Eklenecek Dersin Grubu:</label>
      <input type="number" id="grup" required />
      
      <label>Eklenecek Ders Dahil AlÄ±nan Toplam Kredi:</label>
      <input type="number" id="kredi" required />
      
      <label>Ã‡akÄ±ÅŸma GÃ¼n/Saat:</label>
      <input type="text" id="gunsaat" placeholder="Pazartesi 09:00" required />

      <label>BÃ¶lÃ¼m:</label>
      <select id="bolumSelect">
        <option value="MATEMATÄ°K BÃ–LÃœM BAÅžKANLIÄžINA">MATEMATÄ°K</option>
        <option value="FÄ°ZÄ°K BÃ–LÃœM BAÅžKANLIÄžINA">FÄ°ZÄ°K</option>
        <option value="KÄ°MYA BÃ–LÃœM BAÅžKANLIÄžINA">KÄ°MYA</option>
        <option value="Ä°STATÄ°STÄ°K BÃ–LÃœM BAÅžKANLIÄžINA">Ä°STATÄ°STÄ°K</option>
        <option value="MOLEKÃœLER BÄ°YOLOJÄ° VE GENETÄ°K BÃ–LÃœM BAÅžKANLIÄžINA">MOLEKÃœLER BÄ°YOLOJÄ° VE GENETÄ°K</option>
        <option value="TÃœRK DÄ°LÄ° VE EDEBÄ°YATI BÃ–LÃœM BAÅžKANLIÄžINA">TÃœRK DÄ°LÄ° VE EDEBÄ°YATI</option>
        <option value="BATI DÄ°LLERÄ° VE EDEBÄ°YATLARI BÃ–LÃœM BAÅžKANLIÄžINA">BATI DÄ°LLERÄ° VE EDEBÄ°YATLARI</option>
      </select>

      <button type="submit">ðŸ“„ PDF Ä°ndir</button>
    </form>
  </div>

  <div id="pdf-container">
      <div id="dilekceOutput">
        <p id="bolumYazisi" class="center-text" style="margin-bottom: 1.5cm;"></p>
        <div class="info-row"><span class="info-label">Ad Soyad</span><span class="info-separator">:</span><span id="outAdSoyad"></span></div>
        <div class="info-row"><span class="info-label">Ã–ÄŸrenci No</span><span class="info-separator">:</span><span id="outNo"></span></div>
        <div class="info-row"><span class="info-label">E-posta</span><span class="info-separator">:</span><span id="outEmail"></span></div>
        <div class="info-row"><span class="info-label">Telefon</span><span class="info-separator">:</span><span id="outTel"></span></div>
        <div style="margin-bottom:1cm;"></div>
        <p style="text-align: justify; line-height: 1.5;">
          <span id="otomatikYil"></span> EÄŸitim-Ã–ÄŸretim yÄ±lÄ± <strong><span class="otomatikDonem"></span></strong> dÃ¶neminde Ã§akÄ±ÅŸma nedeniyle alamadÄ±ÄŸÄ±m aÅŸaÄŸÄ±daki dersin 28.08.2025 tarih ve 2025/08-20 sayÄ±lÄ± Senato KararÄ± gereÄŸince Ã–ÄŸrenci Bilgi Sistemine eklenmesi hususunda gereÄŸini arz ederim.
        </p>
        <table>
          <thead>
              <tr>
                <th width="35%">OBS'den SeÃ§ilen Ders</th>
                <th width="35%">Eklenecek Ders</th>
                <th width="10%">Grup</th>
                <th width="20%">GÃ¼n/Saat</th>
              </tr>
          </thead>
          <tbody>
              <tr><td id="obsDersCell"></td><td id="yeniDersCell"></td><td id="grupCell"></td><td id="gunsaatCell"></td></tr>
          </tbody>
        </table>
        <p style="margin-top: 20px;"><strong>Eklenecek Ders Dahil <span class="otomatikDonem"></span> YarÄ±yÄ±lÄ±nda AlÄ±nan Toplam Kredi:</strong> <span id="krediBilgisi"></span></p>
        <p style="text-align: right; margin-top: 30px;" id="tarihYeri"></p>
        <div id="epostaAltMetin"></div>
      </div>
  </div>

  <script>

function formatTelefon(text) {
    let num = text.replace(/\D/g, ''); // Rakam dÄ±ÅŸÄ± her ÅŸeyi sil
    if (num.startsWith('0')) num = num.substring(1); // BaÅŸtaki 0'Ä± at
    if (num.length === 10) {
        return `(${num.substring(0, 3)}) ${num.substring(3, 6)} ${num.substring(6, 10)}`;
    }
    return text; // 10 hane deÄŸilse olduÄŸu gibi bÄ±rak
}

    const { jsPDF } = window.jspdf;

    // E-posta @ kontrolÃ¼
    function emailKontrol(input) {
        if (input.value.includes('@')) {
            alert("LÃ¼tfen sadece e-posta kullanÄ±cÄ± adÄ±nÄ±zÄ± yazÄ±nÄ±z. '@' iÅŸareti ve devamÄ±nÄ± eklemeyiniz.");
            input.value = input.value.replace(/@/g, '');
        }
    }

    function trUpper(text) { return text.replace(/i/g, "Ä°").replace(/Ä±/g, "I").toUpperCase(); }

    function formatDersAdi(text) {
        if (!text) return "";
        let kelimeler = text.trim().split(/\s+/);
        return kelimeler.map((kelime, index) => {
            if (index === 0) return trUpper(kelime);
            return kelime.charAt(0).replace(/i/g, "Ä°").replace(/Ä±/g, "I").toUpperCase() + kelime.slice(1).toLowerCase();
        }).join(" ");
    }

    // GÃ¼n formatlama (Sadece ilk harf bÃ¼yÃ¼k)
    function formatGun(text) {
        if (!text) return "";
        let t = text.trim();
        return t.charAt(0).replace(/i/g, "Ä°").replace(/Ä±/g, "I").toUpperCase() + t.slice(1).toLowerCase();
    }

    document.getElementById("dilekceForm").addEventListener("submit", function(e) {
      e.preventDefault();
      
      const ad = trUpper(document.getElementById("ad").value);
      const soyad = trUpper(document.getElementById("soyad").value);
      const mail = document.getElementById("emailUser").value + "@std.yildiz.edu.tr";
      
      // Verileri Doldur
      document.getElementById("outAdSoyad").innerText = ad + " " + soyad;
      document.getElementById("outNo").innerText = document.getElementById("numara").value;
      document.getElementById("outEmail").innerText = mail;
      document.getElementById("outTel").innerText = formatTelefon(document.getElementById("telefon").value);
      document.getElementById("obsDersCell").innerText = formatDersAdi(document.getElementById("obsDers").value);
      document.getElementById("yeniDersCell").innerText = formatDersAdi(document.getElementById("yeniDers").value);
      document.getElementById("grupCell").innerText = document.getElementById("grup").value;
      document.getElementById("gunsaatCell").innerText = formatGun(document.getElementById("gunsaat").value);
      document.getElementById("krediBilgisi").innerText = document.getElementById("kredi").value;
      document.getElementById("bolumYazisi").innerText = document.getElementById("bolumSelect").value;
      document.getElementById("tarihYeri").innerText = "Tarih: " + new Date().toLocaleDateString("tr-TR");
      document.getElementById("epostaAltMetin").innerText = `Bu belge ${mail} adresinden bÃ¶lÃ¼me iletilmiÅŸtir.`;

      const d = new Date();
      const donem = (d.getMonth() + 1 >= 1 && d.getMonth() + 1 <= 7) ? "BAHAR" : "GÃœZ";
      const akYil = (d.getMonth() + 1 >= 8) ? `${d.getFullYear()}-${d.getFullYear()+1}` : `${d.getFullYear()-1}-${d.getFullYear()}`;
      document.querySelectorAll(".otomatikDonem").forEach(el => el.innerText = donem);
      document.getElementById("otomatikYil").innerText = akYil;

      // PDF OluÅŸturma BaÅŸlat
      const input = document.getElementById('dilekceOutput');
      html2canvas(input, { scale: 2, useCORS: true, backgroundColor: "#FFFFFF" }).then(canvas => {
        const imgData = canvas.toDataURL('image/jpeg', 0.8);
        const pdf = new jsPDF('p', 'mm', 'a4');
        const pdfWidth = pdf.internal.pageSize.getWidth();
        const pdfHeight = (canvas.height * pdfWidth) / canvas.width;
        pdf.addImage(imgData, 'JPEG', 0, 0, pdfWidth, pdfHeight);
        pdf.save(`${ad}_${soyad}_Cakisma_Dilekcesi.pdf`);
      });
    });
  </script>
</body>
</html>


